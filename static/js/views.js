// Generated by CoffeeScript 1.3.3
(function() {

  window.FinderView = Backbone.View.extend({
    el: "#finder",
    events: {
      "keyup #thebox": "search",
      "click .create-group": "createGroup"
    },
    initialize: function() {
      return this.$("#results").html("Start typing <3");
    },
    showGroups: function(models) {
      return this.$("#results").html(Handlebars.templates.foobar({
        groups: models
      }));
    },
    createGroup: function(e) {
      var group, name;
      name = $(e.target).data("name");
      group = new Group({
        name: name
      });
      groups.add(group);
      return group.save();
    },
    search: function(e) {
      var fragment, matches;
      fragment = this.$("#thebox").val();
      if (fragment) {
        matches = groups.filter(function(group) {
          return ~group.get('name').indexOf(fragment);
        });
        if (matches.length > 0) {
          return this.showGroups(matches);
        } else {
          return this.$("#results").html(Handlebars.templates.no_groups({
            name: fragment
          }));
        }
      } else {
        return this.$("#results").html("Start typing <3");
      }
    }
  });

  window.AppView = Backbone.View.extend({
    el: $("body"),
    initialize: function() {
      var _this = this;
      this.finder = new FinderView();
      this.updateGroupList();
      groups.on("add remove", this.updateGroupList, this);
      return socket.on("online", function(people) {
        return _this.updatePersonList(people);
      });
    },
    updateGroupList: function() {
      return this.$("#groups").html(Handlebars.templates.sidebar_groups({
        groups: groups.toJSON()
      }));
    },
    updatePersonList: function(people) {
      return this.$("#people").html(Handlebars.templates.sidebar_people({
        people: people
      }));
    }
  });

}).call(this);
